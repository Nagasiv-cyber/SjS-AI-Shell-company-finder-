# Deployment & Integrated Features Documentation

## 1. Firebase Firestore Schema

The application now integrates with Firebase Firestore. Below are the collections and document structures used:

### `decision_logs`
Stores analyst actions for audit trails (Ethical Oversight).
```json
{
  "type": "ALERT_SUPPRESSION",
  "alert_id": "string",
  "reason": "string",
  "analyst": "string", // User ID
  "timestamp": "timestamp"
}
```

### `case_files`
Stores generated intelligence reports.
```json
{
  "entity_id": "string",
  "title": "string",
  "notes": "string",
  "ai_summary": "string", // Generated by Gemini
  "alerts": ["string"], // List of Alert IDs
  "status": "Draft",
  "created_at": "timestamp"
}
```

## 2. Gemini AI Integration

The backend (`backend/services.py`) proxies requests to Google Gemini Pro.
Authentication: Expects `GEMINI_API_KEY` in environment variables.

### Capabilities:
- **Narrative Generation**: Summarizes entity risk profiles.
- **Typology Detection**: Classifies money laundering patterns.
- **Natural Language Query**: Powers the AI Assistant Console.

## 3. Deployment Notes

### Backend (Python FastAPI)
1. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
2. Set Environment Variables:
   - `GEMINI_API_KEY`: Your Google Cloud Gemini API Key.
   - `GOOGLE_APPLICATION_CREDENTIALS`: Path to your Firebase Admin SDK JSON (optional, defaults to mock).
3. Run Server:
   ```bash
   uvicorn main:app --reload
   ```

### Frontend (React/Vite)
1. Install dependencies:
   ```bash
   npm install
   ```
2. Run Dev Server:
   ```bash
   npm run dev
   ```
3. Build for Firebase Hosting:
   ```bash
   npm run build
   firebase deploy
   ```

## 4. Sample Test Data

### High Risk Entity for Testing
- **Name**: "Alpha Shell Holdings"
- **ID**: `comp_14` (example)
- **Features to Check**:
  - **Typology**: Circular Routing / Layered Networks.
  - **Threat Proximity**: 2-Steps from Sancton List.
  - **Signals**: Conflict-Zone Routing.

### Commands to Try in AI Console
- "Explain why Alpha Shell is high risk"
- "List entities in Panama"
- "Enable Ghost Mode"
